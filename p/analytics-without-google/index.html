<!doctype html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Analytics without Google</title>
    <link href="https://fonts.googleapis.com/css?family=Merriweather&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://andybrewer.github.io/mvp/mvp.css">
    <link rel="stylesheet" href="/static/base.css">
    <link rel="stylesheet" href="/static/pygments.css">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<body>
    
<header>
        <nav>
        <a href="/" class="home">Home</a>
        <a href="https://twitter.com/bartekci"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><title>Twitter icon</title><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"></path></svg></a>
        <a href="https://github.com/bartek"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a>
    </nav>
</header>

    <main>
    
<h1>Analytics without Google</h1>
<p class='published-date'>Last updated Jun 02 2020</p>

    
<article>
    <p>Last week, I launched a <a href="https://freethedocs.app">personal project</a>. A nice change
that most definitely came from a desire to <em>do something else</em> during covid-19
lockdown. With that launch came a desire to have some level of analytics, I
didn't need the full customer journey but I sure was curious how many people
were using my site after I submitted it to Hacker News y'know?</p>
<p>I was also motivated to continue to de-Google my life, something
I've been doing with <a href="https://fastmail.com">email</a>,
<a href="https://digitalocean.com">hosting</a>, and <a href="https://duckduckgo.com">search</a>.</p>
<p>So my little service was running, but analytics! I could grep my <code>nginx</code>
log files to get a gauge, but I wanted something more robust. I discovered a
paid service named <a href="https://simpleanalytics.com">Simple Analytics</a> which offers
privacy-focused analytics that, as the name suggests, are simple.</p>
<p>This was great, but not ideal for me. My application was not generating any
revenue (nor did it have intention to), so I needed something else. For the
record, I do recommend checking them out. </p>
<p>So what was ideal for me?</p>
<ul>
<li><em>Essential</em> analytics. I wasn't after knowing the full customer
    journey, I was just curious how many people were hitting my service over
    time.</li>
<li>Free and ideally open source.</li>
<li>Not invasive to privacy. I don't want to track my users with cookies or sessions.</li>
<li>Built-in interaction with standard *nix log formats and plays nicely with log
    rotation.</li>
<li>Light weight and compilable by me. Ideally I can self-host this and don't have
    to worry about piping my data to another service.</li>
</ul>
<h2>Enter GoAccess</h2>
<p>Immediately, this seemed to meet my primary criteria, with further consideration
for tracking more interesting metrics like application response times. So, I
gave <a href="https://goaccess.io/">GoAccess</a> a try. Installation was trivial and with a simple command, I had output:</p>
<pre><code>./goaccess /var/log/nginx/access.log
</code></pre>
<p>GoAccess plays nicely with Apache and nginx log formats, although it supports a
large variety. This command opens up a Terminal-based visualization of various
panels of data for your server.</p>
<p>This was great and there's even support for HTML based static and real-time
dashboards. The output of which is beautiful:</p>
<p><img alt="HTML Based Dashboard" src="/static/analytics-google/goaccess-dashboard.png" /></p>
<p>(My humble blog and service don't get much traffic, that's OK)</p>
<p>An immediate concern I had was that my logs would rotate. By default when you
install <code>nginx</code>, a <code>logrotate</code> configuration is added to rotate them daily.
Luckily, GoAccess makes it easy to analyse over multiple files:</p>
<pre><code>./goaccess /var/log/nginx/access.log /var/log/nginx/access.log.1
/var/log/nginx/access.log.2
</code></pre>
<p>But this would get frustrating to write and adjust on each rotation. Luckily, we
can leverage the pipe operator. I love how composable unix applications are!</p>
<pre><code>zcat /var/log/nginx/access.log.*.gz | ./goccess /var/log/nginx/access.log -
</code></pre>
<p>The result took a few dozen more milliseconds compared to parsing a single
access file but was otherwise the same experience when browsing the data. Just
more information!</p>
<p><img alt="GoAccess Multiple Logs" src="/static/analytics-google/goaccess-multilog.png" /></p>
<p>Of course, because of the platform we're on (Linux!), we can compose the data
our application will capture in various ways. For example, assuming I rotated logs on a daily basis and wanted 
the last 15 days of log files (including today):</p>
<pre><code>zcat /var/log/nginx/access.log.{1..15}.gz | ./goccess /var/log/nginx/access.log -
</code></pre>
<p>So this was nice. It gave me plenty of what I wanted and I liked the various
output options. Leveraging the operating system, I can use other tools to
specify what kind of data I want parsed and GoAccess treats it all the same.</p>
<h2>Giving it a go</h2>
<p>I scoured the web for a few more options, finding a few others like
<a href="https://www.goatcounter.com/">GoatCounter</a> <s>but it didn't match my full
criteria (in this case, it isn't self-hosted)</s> which looks like a viable
option to review if I hit a wall with GoAccess.</p>
<p>What I further liked about GoAccess is I could run it on a separate machine, transferring
logs from multiple servers into one place, then creating my necessary
dashboards; this isn't a specific feature of GoAccess, but a feature of the Unix
philosophy. This flexibility works well with my seemingly ephemeral Digital Ocean
Droplets, which don't go kaboom on their own, but rather suffer from my own
tendencies to erase and start from scratch.</p>
<p>GoAccess reminded me how beautiful composable tools are. Its feature set is
minimal and it plays nicely with the tools already available to us on a *nix
platform. Do one thing and do it well -- words of wisdom.</p>
</article>

    </main>
</body>
</html>
